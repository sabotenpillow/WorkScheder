{% load static %}
<!DOCTYPE HTML>
<html>
  <head>
    <meta>
    <link href="{% static 'css/fullcalendar.css' %}" rel="stylesheet">
    <link href="{% static 'node_modules/@fullcalendar/core/main.min.css' %}" rel="stylesheet">
    <link href="{% static 'node_modules/@fullcalendar/daygrid/main.min.css' %}" rel="stylesheet">
    {{ domain|json_script:"domain" }}
    <script src="{% static 'js/workSched.js' %}"></script>
    <script src="{% static 'node_modules/@fullcalendar/core/main.min.js' %}"></script>
    <script src="{% static 'node_modules/@fullcalendar/daygrid/main.min.js' %}"></script>
    <script>
      var calendar;
      var months = [
        'January', 'February', 'March', 'April', 'May', 'June',
        'July', 'August', 'September', 'October', 'November', 'December'
      ]
      document.addEventListener('DOMContentLoaded', function(){
        // DOMを取得
        var calendarEl = document.getElementById('calendar');
        // 指定DOMにカレンダープラグインを適用する
        calendar = new FullCalendar.Calendar(calendarEl, {
          plugins: ['dayGrid'],
          eventClick: function(info) {
            //info.event.tile = 
          },
          //events: function(info, get_monthlyWorkSched, err_log) {
          //  get_monthlyWorkSched()
          //}
        });
        calendar.render();
        //addWorkSched(JSON.parse('{{workSched | safe}}'))
        get_monthlyWorkSched();
      });
      var get_monthlyWorkSched = function() {
        document.getElementsByClassName('fc-prev-button')[0]
          .addEventListener('click', function(){get_monthlyWorkSched()})
        document.getElementsByClassName('fc-next-button')[0]
          .addEventListener('click', function(){get_monthlyWorkSched()})
        var date =
          document.getElementsByClassName('fc-left')[0].innerText.split(' ')
        for (e of calendar.getEvents()) {
          e.remove()
        }
        getWorkSched(date[1], months.indexOf(date[0])+1)
      }
      var err_log = function(msg) {
        console.log(msg)
      }
    </script>
  </head>
  <body>
    <div id='calendar'></div>
  </body>
</html>
